class AutoTabs{constructor(t){this.wrapper=t,this.config={speed:parseInt(this.wrapper.getAttribute("ts-tabs-speed"))||5e3,startInView:"false"!==this.wrapper.getAttribute("ts-start-in-view"),hoverPause:"true"===this.wrapper.getAttribute("ts-hover-pause"),manualMode:"true"===this.wrapper.getAttribute("ts-manual-mode")},this.state={mode:this.config.startInView?"IDLE":"AUTO",currentTab:null},this.timer=null,this.init()}init(){this.state.currentTab=this.wrapper.querySelector(".w-tab-link.w--current"),this.wrapper.addEventListener("click",this.handleClick.bind(this),{passive:!0}),this.config.hoverPause&&(this.wrapper.addEventListener("mouseenter",this.handleHover.bind(this),{passive:!0}),this.wrapper.addEventListener("mouseleave",this.handleLeave.bind(this),{passive:!0})),this.config.startInView?new IntersectionObserver((t=>{const[e]=t;e.isIntersecting&&"IDLE"===this.state.mode&&(this.state.mode="AUTO",this.startRotation())}),{threshold:.25}).observe(this.wrapper):this.startRotation()}handleClick(t){const e=t.target.closest(".w-tab-link");e&&!e.dataset.automated&&(this.state.currentTab=e,this.state.mode="MANUAL",this.stopRotation())}handleHover(){"AUTO"===this.state.mode&&this.pauseRotation()}handleLeave(){"MANUAL"!==this.state.mode||this.config.manualMode?"PAUSED"===this.state.mode&&this.resumeRotation():(this.state.mode="AUTO",this.startRotation())}startRotation(){if("AUTO"!==this.state.mode)return;this.showProgress();const t=this.getCurrentLoader();t&&(t.style.transition=`width ${this.config.speed}ms linear`,t.style.width="100%"),this.timer=setTimeout((()=>this.rotateToNextTab()),this.config.speed)}pauseRotation(){if("AUTO"!==this.state.mode)return;this.state.mode="PAUSED",clearTimeout(this.timer);const t=this.getCurrentLoader();if(t){const e=getComputedStyle(t).width,s=t.parentElement.offsetWidth,i=parseFloat(e)/s*100;t.style.transition="none",t.style.width=`${i}%`}}resumeRotation(){if("PAUSED"!==this.state.mode)return;const t=this.getCurrentLoader();if(!t)return;const e=parseFloat(t.style.width),s=this.config.speed*(1-e/100);this.state.mode="AUTO",t.style.transition=`width ${s}ms linear`,t.style.width="100%",this.timer=setTimeout((()=>this.rotateToNextTab()),s)}stopRotation(){clearTimeout(this.timer),this.hideProgress()}rotateToNextTab(){if("AUTO"!==this.state.mode)return;let t=this.state.currentTab.nextElementSibling;t&&t.classList.contains("w-tab-link")||(t=this.wrapper.querySelector(".w-tab-link")),t&&(t.dataset.automated=!0,t.click(),delete t.dataset.automated,this.state.currentTab=t,this.showProgress(),this.startRotation())}getCurrentLoader(){return this.state.currentTab?.querySelector('[ts-progress-bar="loader"]')||null}showProgress(){this.hideProgress();const t=this.state.currentTab;if(!t)return;const e=t.querySelector('[ts-progress-bar="base"]'),s=t.querySelector('[ts-progress-bar="loader"]');e&&(e.style.display="block"),s&&(s.style.transition="none",s.style.display="block",s.style.width="0%",s.offsetWidth)}hideProgress(){this.wrapper.querySelectorAll("[ts-progress-bar]").forEach((t=>{t.style.display="none","loader"===t.getAttribute("ts-progress-bar")&&(t.style.width="0%")}))}destroy(){this.stopRotation(),this.wrapper=null,this.state=null,this.config=null}}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll('[ts-tabs="true"]').forEach((t=>{new AutoTabs(t)}))}));